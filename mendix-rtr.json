{
    "mendix_rtr_log": {
        "title": "Mendix access (RTR) log",
        "regex": {
            "CloudFoundry": {
                "pattern": "^(?<timestamp>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{6})\\s+\\[(?<instance>RTR/\\d+)\\]\\s+(?<hostname>\\S+)\\s+-\\s+\\[(?<time_received>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{9}Z)\\]\\s+\"(?<verb>[A-Z]+)\\s+(?<path>\\S+)\\s+(?<http_spec>\\S+)\"\\s+(?<status>\\d+)\\s+(?<request_size_in_bytes>\\d+)\\s+(?<response_size_in_bytes>\\d+)(?<msg>.+)"
            },
            "Kubernetes": {
                "pattern": "^(?<timestamp>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{6})\\s+\\[nginx/(?<instance>\\w+)\\]\\s+request=\"(?<verb>[A-Z]+)\\s+(?<path>\\S+)\\s+(?<http_spec>[^\"]+)\"\\s+status=\"(?<status>\\d+)\"\\s+request_length_in_bytes=\"(?<request_size_in_bytes>\\d+)\"\\s+response_size_in_bytes=\"(?<response_size_in_bytes>\\d+)\"\\s+response_time_in_seconds=\"(?<response_time_in_seconds>[^\"]+)\"\\s+remote_addr=\"(?<remote_addr>[^\"]+)\"\\s+http_x_forwarded_for=\"(?<http_x_forwarded_for>[^\"]+)\"\\s+http_referer=\"(?<http_referer>[^\"]+)\"\\s+http_user_agent=\"(?<http_user_agent>[^\"]+)\""
            },
            "KubernetesError": {
                "pattern": "^(?<timestamp>\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{6})\\s+\\[nginx/(?<instance>\\w+)\\]\\s+\\[error\\]\\s+(?<msg>.+)"
            }
        },
        "multiline": false,
        "value": {
            "instance": {"kind": "string", "identifier": true},
            "hostname" : {"kind": "string", "identifier": true},
            "time_received": {"kind": "string"},
            "verb": {"kind": "string", "identifier": true},
            "path": {"kind": "string"},
            "http_spec": {"kind": "string"},
            "status": {"kind": "integer", "identifier": true},
            "request_size_in_bytes": {"kind": "integer"},
            "response_size_in_bytes": {"kind":"integer"},
            "response_time_in_seconds": {"kind":"float"},
            "remote_addr": {"kind":"string"},
            "http_x_forwarded_for": {"kind":"string"},
            "http_referer": {"kind":"string"},
            "http_user_agent": {"kind":"string"},
            "msg": {"kind": "string"}
        },    
        "sample": [
            {
                "line": "2025-10-06T23:59:26.755228 [RTR/1]  proximuspluscore.mendixcloud.com - [2025-10-06T23:59:26.734808021Z] \"POST /rest/commons/v1/notificationpreferences HTTP/1.1\" 200 202 0 \"-\" \"ProximusPlus/305554 CFNetwork/3860.100.1 Darwin/25.0.0\" \"10.10.11.57:16188\" \"10.10.136.161:61010\" x_forwarded_for:\"2a02:a020:541:5be0:c9e0:5d5b:288a:18ac, 10.10.11.48, 10.10.11.57\" x_forwarded_proto:\"https\" vcap_request_id:\"8f0dfdc9-1e30-4f5f-432b-25f83b59a95b\" response_time:0.020325 gorouter_time:0.000129 app_id:\"645e21ce-c475-453f-adf0-1e151741ef5e\" app_index:\"2\" instance_id:\"fbc9de26-6449-49ce-6387-6c98\" x_cf_routererror:\"-\" x_b3_traceid:\"8f0dfdc91e304f5f432b25f83b59a95b\" x_b3_spanid:\"432b25f83b59a95b\" x_b3_parentspanid:\"-\" b3:\"8f0dfdc91e304f5f432b25f83b59a95b-432b25f83b59a95b\""
            },
            {
                "line": "2025-10-01T00:01:04.909405 [nginx/4mtsl]   request=\"GET /infophp.php HTTP/1.1\" status=\"403\" request_length_in_bytes=\"473\" response_size_in_bytes=\"625\" response_time_in_seconds=\"0.000\" remote_addr=\"45.79.184.177\" http_x_forwarded_for=\"45.79.184.177, 10.10.11.12\" http_referer=\"-\" http_user_agent=\"Mozilla/5.0 (Debian; Linux i686; rv:121.0) Gecko/20100101 Firefox/121.0\""
            },
            {
                "line": "2025-10-01T00:01:04.915501 [nginx/4mtsl]   [error] 15#15: *65399 access forbidden by rule while sending response to client, client: 45.79.184.177, server: _, request: \"GET /phpinfo.php HTTP/1.1\", host: \"asoko100-accp.mendixcloud.com\""
            },
            {
                "line": "2025-10-06T08:06:29.510474 [nginx/9g7lw]   [error] 15#15: *1382 access forbidden by rule, client: 124.219.162.193, server: _, request: \"GET \/ HTTP/1.1\", host: \"asoko100-accp.mendixcloud.com\""
            }
        ]
        
    }
}